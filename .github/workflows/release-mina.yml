name: 'release mina'
on:
  push:
    branches:
      - main

jobs:
  # check-affected:
  #   runs-on: ubuntu-latest
  #   outputs:
  #     is_mina_affected: ${{ steps.affected.outputs.is_mina_affected }}

  #   steps:
  #     - name: checkout
  #       uses: actions/checkout@v4
  #       with:
  #         fetch-depth: 0
  #     # -------------- START TO REMOVE
  #     # - uses: actions/setup-node@v3
  #     #   with:
  #     #     node-version: 18
  #     # - run: npm install --global yarn
  #     # -------------- END TO REMOVE
  #     - name: setup node
  #       uses: actions/setup-node@v4
  #       with:
  #         node-version: 18
  #         cache: 'yarn'
  #     - uses: nrwl/nx-set-shas@v4
  #     - run: yarn --frozen-lockfile
  #     - name: Affected
  #       run: echo "affected=$(yarn --silent nx show projects --affected --json | jq -Rsa)" >> "$GITHUB_ENV"
  #     # - name: Affected
  #     #   run: echo "affected=[\"keadex-battisti\"]" >> "$GITHUB_ENV"
  #     - name: Is affected
  #       id: affected
  #       run: echo "is_mina_affected=${{ contains(fromJson(env.affected), 'keadex-mina') }}" >> "$GITHUB_OUTPUT"

  # # release-mina:
  # #   runs-on: ubuntu-latest
  # #   needs: check-affected
  # #   if: needs.check-affected.outputs.is_mina_affected == 'true'
  # #   steps:
  # #     - name: check
  # #       run: echo "${{needs.check-affected.outputs.is_mina_affected}}"

  # release-mina:
  #   needs: check-affected
  #   if: needs.check-affected.outputs.is_mina_affected == 'true'
  #   permissions:
  #     contents: write
  #   strategy:
  #     fail-fast: true
  #     matrix:
  #       platform: [macos-latest, ubuntu-20.04, windows-latest]
  #   runs-on: ${{ matrix.platform }}
  #   env:
  #     project_path: ./apps/keadex-mina

  #   steps:
  #     - name: checkout
  #       uses: actions/checkout@v3
  #       with:
  #         fetch-depth: 0
  #     - name: setup node
  #       uses: actions/setup-node@v3
  #       with:
  #         node-version: 18
  #         cache: 'yarn'
  #     - name: install Rust stable
  #       uses: dtolnay/rust-toolchain@stable
  #     - name: install dependencies (ubuntu only)
  #       if: matrix.platform == 'ubuntu-20.04'
  #       run: |
  #         sudo apt-get update
  #         sudo apt-get install -y libgtk-3-dev libwebkit2gtk-4.0-dev libappindicator3-dev librsvg2-dev patchelf
  #     - name: install frontend dependencies
  #       run: yarn --frozen-lockfile
  #     - uses: tauri-apps/tauri-action@v0
  #       env:
  #         GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
  #         TAURI_PRIVATE_KEY: ${{ secrets.TAURI_PRIVATE_KEY }}
  #         TAURI_KEY_PASSWORD: ${{ secrets.TAURI_KEY_PASSWORD }}
  #       with:
  #         tagName: keadex-mina-v__VERSION__ # the action automatically replaces \_\_VERSION\_\_ with the app version
  #         releaseName: 'Keadex Mina v__VERSION__'
  #         releaseBody: 'See the assets to download this version and install.'
  #         projectPath: ${{ env.project_path }}

  update-latest-json:
    # needs: release-mina
    runs-on: ubuntu-latest
    steps:
      - name: download latest latest.json
        run: wget https://github.com/keadex/keadex/releases/latest/download/latest.json
      - name: check
        run: ls

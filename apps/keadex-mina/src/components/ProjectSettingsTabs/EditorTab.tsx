import { Input, Radio } from '@keadex/keadex-ui-kit/cross'
import { Dispatch, memo, SetStateAction } from 'react'
import { useTranslation } from 'react-i18next'

import { ProjectSettings } from '../../models/autogenerated/ProjectSettings'

export type EditorTabProps = {
  setNewProjectSettings: Dispatch<SetStateAction<ProjectSettings | undefined>>
  autosaveEnabled: boolean
  autosaveIntervalSeconds: number | null
}

export const EditorTab = memo((props: EditorTabProps) => {
  const { t } = useTranslation()
  const { setNewProjectSettings, autosaveEnabled, autosaveIntervalSeconds } =
    props

  return (
    <div>
      <div className={`flex flex-row mt-6`}>
        <span>{`${t('common.autosave')}*`}:</span>
        <Radio<boolean>
          id="autosave-status"
          className="ml-5"
          value={autosaveEnabled}
          options={[
            { label: t('common.enabled'), value: true },
            { label: t('common.disabled'), value: false },
          ]}
          onChange={(value: boolean) => {
            setNewProjectSettings((prev) => {
              if (prev)
                return {
                  ...prev,
                  autosave_enabled: value,
                  autosave_interval_seconds: value ? 60 : 0,
                }
            })
          }}
        />
      </div>
      <Input
        type="number"
        max={240}
        label={`${t('common.autosave_interval_sec')}`}
        info={`${t('common.max')} 240 ${t('common.seconds').toLowerCase()}`}
        className="mt-6"
        value={autosaveIntervalSeconds !== null ? autosaveIntervalSeconds : 0}
        onChange={(e) => {
          setNewProjectSettings((prev) => {
            if (prev)
              return {
                ...prev,
                autosave_interval_seconds:
                  e.target.value.length > 0
                    ? Number.parseInt(e.target.value)
                    : 0,
              }
          })
        }}
      />
    </div>
  )
})

export default EditorTab
